<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Artifact.</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://artifact.me/"/>
  <updated>2020-05-13T04:13:59.833Z</updated>
  <id>http://artifact.me/</id>
  
  <author>
    <name>Art Chen</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Headless Wordpress with Gatsby</title>
    <link href="http://artifact.me/headless-wordpress-with-gatsby/"/>
    <id>http://artifact.me/headless-wordpress-with-gatsby/</id>
    <published>2020-05-13T04:12:24.000Z</published>
    <updated>2020-05-13T04:13:59.833Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
    
      <category term="Wordpress" scheme="http://artifact.me/tags/wordpress/"/>
    
      <category term="Gatsby" scheme="http://artifact.me/tags/gatsby/"/>
    
  </entry>
  
  <entry>
    <title>Dark Mode is Cool</title>
    <link href="http://artifact.me/dark-mode-is-cool/"/>
    <id>http://artifact.me/dark-mode-is-cool/</id>
    <published>2020-04-08T06:07:46.000Z</published>
    <updated>2020-04-08T06:29:47.622Z</updated>
    
    <content type="html"><![CDATA[<p>I was skeptical about the “dark mode” hype but it turned out pretty darn good with this theme. Now the hesitation is whether to make dark the new default.</p><p>Home page:</p><p><a href="https://cdn.artifact.me/images/themes/dark-mode-1.jpg" target="_blank" rel="noopener"><img src="https://cdn.artifact.me/images/themes/dark-mode-1.jpg" alt="Dark Mode Demo"></a></p><p>Article page:</p><p><a href="https://cdn.artifact.me/images/themes/dark-mode-2.jpg" target="_blank" rel="noopener"><img src="https://cdn.artifact.me/images/themes/dark-mode-2.jpg" alt="Dark Mode Demo"></a></p><p>By the way here is the simple media query that does the magic.</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> (<span class="attribute">prefers-color-scheme:</span> dark) &#123;</span><br><span class="line">  <span class="comment">/* Your rules */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Reference: <a href="https://css-tricks.com/dark-modes-with-css/" target="_blank" rel="noopener">https://css-tricks.com/dark-modes-with-css/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;I was skeptical about the “dark mode” hype but it turned out pretty darn good with this theme. Now the hesitation is whether to make dark
      
    
    </summary>
    
    
    
      <category term="Theme" scheme="http://artifact.me/tags/theme/"/>
    
  </entry>
  
  <entry>
    <title>Connect GCP App Engine to Cloud SQL</title>
    <link href="http://artifact.me/connect-gcp-app-engine-to-cloud-sql/"/>
    <id>http://artifact.me/connect-gcp-app-engine-to-cloud-sql/</id>
    <published>2019-06-03T14:44:18.000Z</published>
    <updated>2020-04-05T01:55:34.058Z</updated>
    
    <content type="html"><![CDATA[<p>This is another quick note for my own reference. For most steps I followed this documentation: <a href="https://cloud.google.com/appengine/docs/flexible/nodejs/using-cloud-sql" target="_blank" rel="noopener">Using Cloud SQL for MySQL</a>, but there are some gotchas that are worth noting.</p><p>Before getting into the details, here are some background information for readers. My goal is to set up a node.js application on Google Cloud <a href="https://cloud.google.com/appengine/" target="_blank" rel="noopener">App Engine</a>. I use a MySQL instance on <a href="https://cloud.google.com/sql/docs/" target="_blank" rel="noopener">Cloud SQL</a>, and I access my DB via <a href="http://docs.sequelizejs.com/" target="_blank" rel="noopener">Sequelize</a>.</p><h2 id="Sequelize-configuration"><a href="#Sequelize-configuration" class="headerlink" title="Sequelize configuration"></a>Sequelize configuration</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  dialectOptions: &#123;</span><br><span class="line">    <span class="comment">// socketPath: '/cloudsql/&#123;project-id&#125;:&#123;region&#125;:&#123;cloudsql-instance-name&#125;'</span></span><br><span class="line">    socketPath: <span class="string">`/cloudsql/<span class="subst">$&#123;process.env.CLOUD_SQL_CONNECTION_NAME&#125;</span>`</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Do not include host and port, or put host the same value as socketPath.</p><h2 id="app-yaml"><a href="#app-yaml" class="headerlink" title="app.yaml"></a>app.yaml</h2><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">env_variables:</span></span><br><span class="line">  <span class="attr">CLOUD_SQL_CONNECTION_NAME:</span> <span class="string">&#123;project-id&#125;:&#123;region&#125;:&#123;cloudsql-instance-name&#125;</span></span><br><span class="line"><span class="attr">beta_settings:</span></span><br><span class="line">  <span class="attr">cloud_sql_instances:</span> <span class="string">&#123;project-id&#125;:&#123;region&#125;:&#123;cloudsql-instance-name&#125;</span></span><br></pre></td></tr></table></figure><p>The <code>beta_settings</code> part can be easy to miss.</p><h2 id="Permission"><a href="#Permission" class="headerlink" title="Permission"></a>Permission</h2><p>This part turns out unexpected, I didn’t figure it out until diving into error logs.</p><p>It seems both Cloud SQL API and Cloud SQL Admin API needs to be enabled. Both are not enabled by default. The documentation mentioned about Cloud SQL API, but I didn’t know Admin API is also required until actually try to deploy the app.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;This is another quick note for my own reference. For most steps I followed this documentation: &lt;a href=&quot;https://cloud.google.com/appengin
      
    
    </summary>
    
    
    
      <category term="gcp" scheme="http://artifact.me/tags/gcp/"/>
    
  </entry>
  
  <entry>
    <title>Wordpress with Nginx and PHP7 on AWS EC2 and RDS</title>
    <link href="http://artifact.me/wordpress-with-nginx-and-php7-on-aws-ec2-rds/"/>
    <id>http://artifact.me/wordpress-with-nginx-and-php7-on-aws-ec2-rds/</id>
    <published>2018-04-27T23:11:17.000Z</published>
    <updated>2020-04-05T01:55:34.060Z</updated>
    
    <content type="html"><![CDATA[<p>I recently installed wordpress on my EC2 host. Regret a lot that I didn’t note down the steps right away. Now I have to rely on my poor goldfish memory.</p><h1 id="Install-Packages"><a href="#Install-Packages" class="headerlink" title="Install Packages"></a>Install Packages</h1><p>Note:</p><ul><li>I use Amazon Linux.</li><li>I didn’t install mysql on localhost because I have an RDS instance.</li><li>My host already has nginx installed.</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo yum install -y php70 php70-fpm php70-gd</span><br><span class="line">sudo chkconfig php-fpm-7.0 on</span><br></pre></td></tr></table></figure><h1 id="Configure-PHP-FPM"><a href="#Configure-PHP-FPM" class="headerlink" title="Configure PHP-FPM"></a>Configure PHP-FPM</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/php-fpm-7.0.d/www.conf</span><br></pre></td></tr></table></figure><p>Make sure these are present and uncommented:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">user = nginx</span><br><span class="line">group = nginx</span><br><span class="line">listen = 127.0.0.1:9000</span><br></pre></td></tr></table></figure><h1 id="Download-Wordpress"><a href="#Download-Wordpress" class="headerlink" title="Download Wordpress"></a>Download Wordpress</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/www</span><br><span class="line">wget https://wordpress.org/latest.tar.gz</span><br><span class="line">tar xvf latest.tar.gz</span><br></pre></td></tr></table></figure><p>Modify permissions. Grant folders 755 and files 644.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo chown nginx:nginx -R /var/www/wordpress</span><br><span class="line">sudo find /var/www/wordpress -<span class="built_in">type</span> d -<span class="built_in">exec</span> chmod 755 &#123;&#125; \;</span><br><span class="line">sudo find /var/www/wordpress -<span class="built_in">type</span> f -<span class="built_in">exec</span> chmod 644 &#123;&#125; \;</span><br></pre></td></tr></table></figure><h1 id="Configure-Nginx"><a href="#Configure-Nginx" class="headerlink" title="Configure Nginx"></a>Configure Nginx</h1><p>Create a new nginx site configuration.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/nginx/sites-available/blog.otakism.com</span><br></pre></td></tr></table></figure><p>With the following content.</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    listen [::]:80;</span><br><span class="line">    listen 443 ssl;</span><br><span class="line">    listen [::]:443 ssl;</span><br><span class="line">    </span><br><span class="line">    server_name blog.otakism.com;</span><br><span class="line">    root &#x2F;var&#x2F;www&#x2F;wordpress;</span><br><span class="line">    charset utf-8;</span><br><span class="line">    </span><br><span class="line">    index index.php index.html;</span><br><span class="line">    </span><br><span class="line">    location &#x2F; &#123;</span><br><span class="line">        try_files $uri $uri&#x2F; &#x2F;index.php?$args;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    location &#x3D; &#x2F;favicon.ico &#123;</span><br><span class="line">        log_not_found off;</span><br><span class="line">        access_log off;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    location ~ \.php$ &#123;</span><br><span class="line">        fastcgi_intercept_errors on;</span><br><span class="line">        fastcgi_index index.php;</span><br><span class="line">        fastcgi_pass 127.0.0.1:9000;</span><br><span class="line">        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class="line">        include fastcgi_params;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    location ~ &#x2F;\. &#123;</span><br><span class="line">        deny all;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    location ~* &#x2F;(?:uploads|files)&#x2F;.*\.php$ &#123;</span><br><span class="line">        deny all;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    ssh_client_certificate &#x2F;etc&#x2F;nginx&#x2F;ssl&#x2F;cloudflare.pem;</span><br><span class="line">    ssl_verify_client on;</span><br><span class="line">    </span><br><span class="line">    ssl on;</span><br><span class="line">    ssl_certificate &#x2F;etc&#x2F;nginx&#x2F;ssl&#x2F;otakism.crt.pem;</span><br><span class="line">    ssl_certificate_key &#x2F;etc&#x2F;nginx&#x2F;ssh&#x2F;otakism.key.pem;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Simlink the configuration file to <code>sites-enabled</code>.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ln -s /etc/nginx/sites-available/blog.otakism.com /etc/nginx/sites-enabled/blog.otakism.com</span><br></pre></td></tr></table></figure><p>Restart nginx.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo service nginx restart</span><br></pre></td></tr></table></figure><h1 id="Gotchas"><a href="#Gotchas" class="headerlink" title="Gotchas"></a>Gotchas</h1><p>Make sure EC2 can talk to RDS. Set up the RDS security group to allow inbound TCP request to the db port from the EC2 host.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;I recently installed wordpress on my EC2 host. Regret a lot that I didn’t note down the steps right away. Now I have to rely on my poor g
      
    
    </summary>
    
    
    
      <category term="Nginx" scheme="http://artifact.me/tags/nginx/"/>
    
      <category term="AWS" scheme="http://artifact.me/tags/aws/"/>
    
      <category term="EC2" scheme="http://artifact.me/tags/ec2/"/>
    
      <category term="RDS" scheme="http://artifact.me/tags/rds/"/>
    
      <category term="Wordpress" scheme="http://artifact.me/tags/wordpress/"/>
    
      <category term="PHP" scheme="http://artifact.me/tags/php/"/>
    
  </entry>
  
  <entry>
    <title>Install Ghost v1.x on Heroku</title>
    <link href="http://artifact.me/install-ghost-v1-on-heroku/"/>
    <id>http://artifact.me/install-ghost-v1-on-heroku/</id>
    <published>2018-04-27T14:00:33.000Z</published>
    <updated>2020-04-05T01:55:34.059Z</updated>
    
    <content type="html"><![CDATA[<p>Heroku has always been my favorite platform for hosting prototypes and demo apps. I have 2 <a href="https://ghost.org/" target="_blank" rel="noopener">Ghost</a> sites hosted on Heroku for display 2 of my Ghost themes. I haven’t touched either of them since 2016 and they have been running without a problem. However, as I checked out what has changed to Ghost since 2016, I found out the core code changes make it harder to deploy new versions (v1.0 and above) to Heroku. Fortunately there is a solution, and here is how it works.</p><p>Note that this post is very specific to my use case: upgrade a demo site from Ghost v0.11.x to v1.22.x. The solution will make some small changes to Ghost core code, which makes future upgrades harder to maintain. I am OK with it because I am not going to frequently update these demo sites. But if you are deploying serious projects, or a frequently updated blog, my solution is not great.</p><h1 id="Before-Getting-Started"><a href="#Before-Getting-Started" class="headerlink" title="Before Getting Started"></a>Before Getting Started</h1><p>Make sure you have git, Node.js and npm.</p><p>Install Heroku CLI: <a href="https://devcenter.heroku.com/articles/heroku-cli" target="_blank" rel="noopener">https://devcenter.heroku.com/articles/heroku-cli</a></p><h1 id="Download-Ghost"><a href="#Download-Ghost" class="headerlink" title="Download Ghost"></a>Download Ghost</h1><p>Download the <code>.zip</code> version of Ghost source code from <a href="https://ghost.org/developers/" target="_blank" rel="noopener">https://ghost.org/developers/</a>. Unzip it to a folder.</p><h1 id="Initialize-Git-Project"><a href="#Initialize-Git-Project" class="headerlink" title="Initialize Git Project"></a>Initialize Git Project</h1><p>I highly recommend you not do the <code>git push --force</code>. I did because I really don’t care.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git init</span><br><span class="line">git add -A</span><br><span class="line">git commit -m <span class="string">"init project"</span></span><br><span class="line">git remote add origin &lt;your-heroku-git-url&gt;</span><br><span class="line">git push --force --<span class="built_in">set</span>-upstream origin master</span><br></pre></td></tr></table></figure><h1 id="Set-up-MySQL"><a href="#Set-up-MySQL" class="headerlink" title="Set up MySQL"></a>Set up MySQL</h1><p>Ghost v1+ only officially supports MySQL. So you need to deploy a MySQL add-on. Either do it via Heroku console or using this command:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">heroku addons:create cleardb:ignite</span><br></pre></td></tr></table></figure><p>Find database connection credentials by going to Settings tab and look for the <code>CLEARDB_DATABASE_URL</code> config variable, or using this command:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">heroku config:get CLEARDB_DATABASE_URL</span><br></pre></td></tr></table></figure><p>It should look like <code>mysql://&lt;db-user&gt;:&lt;db-password&gt;@&lt;db-host&gt;/&lt;db-ame&gt;</code>;</p><p>Set some more config variables:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">heroku config:<span class="built_in">set</span> \ </span><br><span class="line">database__connection__user=&lt;db-user&gt; \ </span><br><span class="line">database__connection__password=&lt;db-password&gt; \ </span><br><span class="line">database__connection__host=&lt;db-host&gt; \</span><br><span class="line">database__connection__database=&lt;db-name&gt; \</span><br><span class="line">database__pool__max=2</span><br></pre></td></tr></table></figure><p>These config variables will make sure the database connection credentials be picked up by Ghost.</p><p>Run the following command to initialize the database. You can also run it from Heroku console. Click the ‘More’ dropdown and choose Run Console, type in <code>bash</code> and hit enter. You will be able to run shell commands in your dyno.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">heroku run <span class="string">"knex-migrator init"</span></span><br></pre></td></tr></table></figure><p>It will fail, at least it did it to me. The error will look like <code>Error: Tarn: opt.max must be an integer &gt; 0</code>.</p><p>The solution is to change a core file <code>core/server/config/index.js</code>, look for this snippet:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">nconf.env(&#123;</span><br><span class="line">  separator: <span class="string">'__'</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>Change it to:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">nconf.env(&#123;</span><br><span class="line">  separator: <span class="string">'__'</span>,</span><br><span class="line">  parseValues: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>Thanks to this Github issue: <a href="https://github.com/tgriesser/knex/issues/2570" target="_blank" rel="noopener">https://github.com/tgriesser/knex/issues/2570</a></p><h1 id="Configurate-Ghost"><a href="#Configurate-Ghost" class="headerlink" title="Configurate Ghost"></a>Configurate Ghost</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">heroku config:<span class="built_in">set</span> server__host=0.0.0.0</span><br><span class="line">heroku config:<span class="built_in">set</span> url=https://yabu.rakugaki.me</span><br></pre></td></tr></table></figure><p>Add the following to <code>core/server/config/index.js</code> so that Ghost can pick up the $PORT env variable.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">nconf.set(<span class="string">'server'</span>, &#123;</span><br><span class="line">  port: process.env.PORT</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>Now do another deployment and the Ghost site should be running on Heroku.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Heroku has always been my favorite platform for hosting prototypes and demo apps. I have 2 &lt;a href=&quot;https://ghost.org/&quot; target=&quot;_blank&quot; r
      
    
    </summary>
    
    
    
      <category term="Ghost" scheme="http://artifact.me/tags/ghost/"/>
    
      <category term="Heroku" scheme="http://artifact.me/tags/heroku/"/>
    
  </entry>
  
  <entry>
    <title>Hexo Theme Element</title>
    <link href="http://artifact.me/hexo-theme-element/"/>
    <id>http://artifact.me/hexo-theme-element/</id>
    <published>2017-12-25T17:13:51.000Z</published>
    <updated>2020-04-05T01:55:34.058Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Element</strong> is another minimal theme for <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>.</p><h2 id="Dependencies"><a href="#Dependencies" class="headerlink" title="Dependencies"></a>Dependencies</h2><p>This theme depends on the following Hexo plugins:</p><ul><li>hexo-generator-tag</li><li>hexo-generator-feed</li><li>hexo-renderer-ejs</li><li>hexo-renderer-less</li><li>hexo-renderer-marked</li><li>hexo-pagination</li><li>hexo-all-minifier</li><li>hexo-autoprefixer</li><li>hexo-front-matter</li></ul><p>For local search, you also need hexo-generator-json-content and add configuration to your global <code>_config.yml</code> if needed, refer to <a href="https://github.com/alexbruno/hexo-generator-json-content" target="_blank" rel="noopener">hexo-generator-json-content</a> github repository.</p><h2 id="Customization"><a href="#Customization" class="headerlink" title="Customization"></a>Customization</h2><p>Element is customizable via the <code>_config.yml</code> in the theme directory.</p><p>Element also depends on the global <code>_config.yml</code>. For example:</p><ul><li>Set <code>disqus_shortname</code> field to your disqus short name.</li><li>Set <code>theme</code> field to <code>hexo-theme-element</code>.</li><li>Set <code>title</code>, <code>url</code>, <code>author</code> and <code>description</code>.</li></ul><p>In addition to these settings, you may also want to edit/replace the following files:</p><ul><li>Replace the author avatar: <code>source/img/avatar.png</code>.</li><li>The font used on <a href="https://artifact.me">Artifact.me</a> is Futura PT. I include it via Adobe Typekit. You need to use your own web font service, or go with the default Lato via Google Font. Details in <code>layout/_partial/head.ejs</code>.</li></ul><p>This theme currently supports 4 search services:</p><ul><li>Google custom search</li><li>Hexo Local search (hexo-json-content)</li><li>Algolia search</li><li>Microsoft Azure search</li></ul><p>Setup guide for searching is availble here: <a href="https://github.com/artchen/universal-search" target="_blank" rel="noopener">universal-search</a>.</p><h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p><a href="https://artifact.me">Artifact.me</a></p><h2 id="Copyright"><a href="#Copyright" class="headerlink" title="Copyright"></a>Copyright</h2><p>Public resources used in this theme:</p><ul><li><a href="https://icomoon.io/" target="_blank" rel="noopener">icomoon</a></li><li><a href="https://necolas.github.io/normalize.css/" target="_blank" rel="noopener">normalize.css</a></li><li><a href="https://fonts.google.com/specimen/Lato" target="_blank" rel="noopener">Google Fonts - Lato</a></li></ul><p>Copyright © Art Chen</p><p>Please do not remove the “Theme by Art Chen” text and links.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;Element&lt;/strong&gt; is another minimal theme for &lt;a href=&quot;https://hexo.io&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;.&lt;/p&gt;&lt;h2 id=&quot;Depen
      
    
    </summary>
    
    
    
      <category term="Theme" scheme="http://artifact.me/tags/theme/"/>
    
      <category term="Hexo" scheme="http://artifact.me/tags/hexo/"/>
    
      <category term="Element" scheme="http://artifact.me/tags/element/"/>
    
  </entry>
  
  <entry>
    <title>Universal Search #6 Baidu Search</title>
    <link href="http://artifact.me/universal-search-6-baidu-search/"/>
    <id>http://artifact.me/universal-search-6-baidu-search/</id>
    <published>2016-09-05T08:39:49.000Z</published>
    <updated>2020-04-05T01:55:34.060Z</updated>
    
    <content type="html"><![CDATA[<p>This is the 6th article in a series that covers the steps to add searching to <a href="http://ghost.org" target="_blank" rel="noopener">Ghost</a>, <a href="http://hexo.io" target="_blank" rel="noopener">Hexo</a> or any general website using APIs provided by various services.</p><p>We have covered UI and common logics in <a href="/universal-search-1-common-logic/">the first article</a>. This time we are going to explore <a href="http://zn.baidu.com/cse/home/index" target="_blank" rel="noopener">Baidu Search</a>.</p><p><del>Since the service is all in Chinese, please refer to <a href="http://otakism.org/universal-search" target="_blank" rel="noopener">this article</a> for content of this article.</del></p><p>I quited on this. In short term there won’t be Baidu search support in the universal search series.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;This is the 6th article in a series that covers the steps to add searching to &lt;a href=&quot;http://ghost.org&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;G
      
    
    </summary>
    
    
    
      <category term="Ghost" scheme="http://artifact.me/tags/ghost/"/>
    
      <category term="Hexo" scheme="http://artifact.me/tags/hexo/"/>
    
      <category term="Search" scheme="http://artifact.me/tags/search/"/>
    
      <category term="API" scheme="http://artifact.me/tags/api/"/>
    
  </entry>
  
  <entry>
    <title>Universal Search #5 Azure Search</title>
    <link href="http://artifact.me/universal-search-5-azure-search/"/>
    <id>http://artifact.me/universal-search-5-azure-search/</id>
    <published>2016-09-04T05:30:34.000Z</published>
    <updated>2020-04-05T01:55:34.060Z</updated>
    
    <content type="html"><![CDATA[<p>This is the 5th article in a series that covers the steps to add searching to <a href="http://ghost.org" target="_blank" rel="noopener">Ghost</a>, <a href="http://hexo.io" target="_blank" rel="noopener">Hexo</a> or any general website using APIs provided by various services.</p><p>The latest version of Universal Search is available on Github at <a href="https://github.com/artchen/universal-search" target="_blank" rel="noopener">https://github.com/artchen/universal-search</a>.</p><p>We have covered UI and common logics in <a href="/universal-search-1-common-logic/">the first article</a>. In this article we are going to explore <a href="https://azure.microsoft.com/en-us/services/search/" target="_blank" rel="noopener">Azure Search</a>.</p><h1 id="Register-for-Service"><a href="#Register-for-Service" class="headerlink" title="Register for Service"></a>Register for Service</h1><p>First of all, register an Azure account or just use your Microsoft account (outlook.com, hotmail.com, etc), and start your free trial.</p><p>Go to the dashboard, and create a new service.</p><p><a href="https://cdn.otakism.com/images/universal-search/azure/azure-01.png" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/azure/azure-01.png" alt="Azure-01"></a></p><p>Search “Azure Search”.</p><p><a href="https://cdn.otakism.com/images/universal-search/azure/azure-02.png" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/azure/azure-02.png" alt="Azure-02"></a></p><p>Create a free Azure Search service. The creation might take a few minutes.</p><p><a href="https://cdn.otakism.com/images/universal-search/azure/azure-03.png" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/azure/azure-03.png" alt="Azure-03"></a></p><p>Go to the control panel of your new Azure Search service. Choose Keys to reveal admin keys. Note down your primary admin key. We need this admin key to access the REST API.</p><p><a href="https://cdn.otakism.com/images/universal-search/azure/azure-04.png" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/azure/azure-04.png" alt="Azure-04"></a></p><p>On the same panel, select “Manage query keys” and create a new query key. Note it down again. This query key will be used on the front-end to query your created index.</p><p><a href="https://cdn.otakism.com/images/universal-search/azure/azure-05.png" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/azure/azure-05.png" alt="Azure-05"></a></p><h1 id="Generate-and-upload-data"><a href="#Generate-and-upload-data" class="headerlink" title="Generate and upload data"></a>Generate and upload data</h1><p>Just like <a href="https://www.algolia.com/" target="_blank" rel="noopener">Algolia</a>, Azure Search does not index your website automatically. Instead, it requires the users to create indexes and upload data.</p><p>In this tutorial, I will use <a href="https://github.com/artchen/hexo-azuresearch" target="_blank" rel="noopener">hexo-azuresearch</a>, a plugin that I wrote, to demonstrate how to integrate Azure Search with Hexo. If your website is on other platforms, Azure provides detailed documentation about all the APIs it supports so it should not be too complicated to write your own indexer and data uploader.</p><p>A heads up notice for non-English users, at this point I cannot get Azure Search to work with other languages. I will look into this issue.</p><h2 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-azuresearch</span><br></pre></td></tr></table></figure><p>In your global <code>_config.yml</code>, add the following configuration:</p><p>In order for our front-end to work, you must include <code>title</code>, <code>excerpt:strip</code> and <code>path</code>. The other fields only help with searching accuracy.</p><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Azure Search</span></span><br><span class="line"><span class="attr">AzureSearch:</span></span><br><span class="line">  <span class="attr">serviceURL:</span> <span class="string">"https://&lt;your-service-name&gt;.search.windows.net"</span></span><br><span class="line">  <span class="attr">indexName:</span> <span class="string">"&lt;your-index-name&gt;"</span></span><br><span class="line">  <span class="attr">adminKey:</span> <span class="string">"&lt;your-azure-search-admin-key&gt;"</span></span><br><span class="line">  <span class="attr">analyzer:</span> <span class="string">"zh-Hans.lucene"</span> <span class="comment"># optional</span></span><br><span class="line">  <span class="attr">fields:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">title</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">excerpt:strip</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">content:strip</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">path</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">permalink</span></span><br></pre></td></tr></table></figure><p>Then run the following command to index and upload data:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo azuresearch</span><br></pre></td></tr></table></figure><h2 id="Ghost"><a href="#Ghost" class="headerlink" title="Ghost"></a>Ghost</h2><p>Unfortunately there is no existing support for Ghost.</p><h1 id="Build-the-class"><a href="#Build-the-class" class="headerlink" title="Build the class"></a>Build the class</h1><p>This section is more of a development note. Plugin users don’t have to read it.</p><p>The class for Azure Search is very similar to the one we built for <a href="/universal-search-2-google-custom-search-engine/">Google Custom Search Engine</a>. The only differences are the credentials and data formats.</p><script src="https://gist.github.com/artchen/a480bf1e066ca7412a2f20c40961782d.js"></script><h1 id="Enable-your-search"><a href="#Enable-your-search" class="headerlink" title="Enable your search"></a>Enable your search</h1><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> customSearch = <span class="keyword">new</span> AzureSearch(&#123;</span><br><span class="line">  serviceName: AZURE_SERVICE_NAME,</span><br><span class="line">  indexName: AZURE_INDEX_NAME,</span><br><span class="line">  queryKey: AZURE_QUERY_KEY</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;This is the 5th article in a series that covers the steps to add searching to &lt;a href=&quot;http://ghost.org&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;G
      
    
    </summary>
    
    
    
      <category term="Ghost" scheme="http://artifact.me/tags/ghost/"/>
    
      <category term="Hexo" scheme="http://artifact.me/tags/hexo/"/>
    
      <category term="Search" scheme="http://artifact.me/tags/search/"/>
    
      <category term="API" scheme="http://artifact.me/tags/api/"/>
    
  </entry>
  
  <entry>
    <title>Universal Search #4 Algolia Search</title>
    <link href="http://artifact.me/universal-search-4-algolia-search/"/>
    <id>http://artifact.me/universal-search-4-algolia-search/</id>
    <published>2016-09-01T04:55:18.000Z</published>
    <updated>2020-04-05T01:55:34.060Z</updated>
    
    <content type="html"><![CDATA[<p>This is the 4th article in a series that covers the steps to add searching to <a href="http://ghost.org" target="_blank" rel="noopener">Ghost</a>, <a href="http://hexo.io" target="_blank" rel="noopener">Hexo</a> or any general website using APIs provided by various services.</p><p>The latest version of Universal Search is available on Github at <a href="https://github.com/artchen/universal-search" target="_blank" rel="noopener">https://github.com/artchen/universal-search</a>.</p><p>We have covered UI and common logics in <a href="/universal-search-1-common-logic/">the first article</a>. This time we are going to explore <a href="https://www.algolia.com/" target="_blank" rel="noopener">Algolia</a>, a wonderful tool to index your website.</p><h1 id="Create-an-index"><a href="#Create-an-index" class="headerlink" title="Create an index"></a>Create an index</h1><p>First of all you need to register at <a href="https://www.algolia.com/" target="_blank" rel="noopener">www.algolia.com</a>.</p><p>Algolia will guide you to create the first application, you can choose a server location based on your target users.</p><p><a href="https://cdn.otakism.com/images/universal-search/algolia/algolia-01.png" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/algolia/algolia-01.png" alt="Algolia-01"></a></p><p>If a tutorial pops up, you can skip it. Go straight to create an index.</p><p><a href="https://cdn.otakism.com/images/universal-search/algolia/algolia-02.png" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/algolia/algolia-02.png" alt="Algolia-02"></a></p><p>Go to API Keys and find your credentials. You will need the Application ID, the Search-only API key and the Admin API key in the following sections.</p><p><a href="https://cdn.otakism.com/images/universal-search/algolia/algolia-03.png" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/algolia/algolia-03.png" alt="Algolia-03"></a></p><h1 id="Generate-and-upload-data"><a href="#Generate-and-upload-data" class="headerlink" title="Generate and upload data"></a>Generate and upload data</h1><p>Algolia requires users to upload their search index data either manually or via provided APIs. They provide many integration sdks available at <a href="https://www.algolia.com/integrations" target="_blank" rel="noopener">https://www.algolia.com/integrations</a>. Most of them are well documented.</p><p>If your website have back-end (database, server logics, etc), most likely Algolia already provide an server-side client. Just go ahead and follow their instructions.</p><p>If you are using a static site generator like Hexo, you might need to code a plugin so that every time you generate the site, the program will also upload a copy of index to Algolia. Currently the only official Algolia plugin for static site generator is Jekyll.</p><p>I will only cover the integration with Hexo here since it is not yet officially supported.</p><h2 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h2><p>Install and configure <a href="https://github.com/LouisBarranqueiro/hexo-algoliasearch" target="_blank" rel="noopener">hexo-algoliasearch</a> in your Hexo directory. This plugin will index your site and upload selected data to Algolia.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-algoliasearch</span><br></pre></td></tr></table></figure><p>In your global <code>_config.yml</code>, add the following configuration:</p><p>In order for our front-end javascript to work, you must include <code>title</code>, <code>excerpt:strip</code> and <code>path</code>. The other fields only help with searching accuracy.</p><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Algolia</span></span><br><span class="line"><span class="attr">algolia:</span></span><br><span class="line">  <span class="attr">appId:</span> <span class="string">"YOUR ALGOLIA APPLICATION ID"</span></span><br><span class="line">  <span class="attr">apiKey:</span> <span class="string">"YOUR ALGOLIA SEARCH-ONLY API KEY"</span></span><br><span class="line">  <span class="attr">adminApiKey:</span> <span class="string">"YOUR ALGOLIA ADMIN API KEY"</span></span><br><span class="line">  <span class="attr">chunkSize:</span> <span class="number">5000</span></span><br><span class="line">  <span class="attr">indexName:</span> <span class="string">"YOUR INDEX NAME"</span></span><br><span class="line">  <span class="attr">fields:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">title</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">excerpt:strip</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">path</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">content:strip</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">permalink</span></span><br></pre></td></tr></table></figure><p>Then run the following command to upload data:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo algolia</span><br></pre></td></tr></table></figure><h2 id="Ghost"><a href="#Ghost" class="headerlink" title="Ghost"></a>Ghost</h2><p>Unfortunately there is no existing support for Ghost.</p><h1 id="Build-the-class"><a href="#Build-the-class" class="headerlink" title="Build the class"></a>Build the class</h1><p>This section is more of a development note. Plugin users don’t have to read it.</p><p>The class for Algolia is very similar to the one we built for <a href="/universal-search-2-google-custom-search-engine/">Google Custom Search Engine</a>. The only differences are the data formats.</p><p>For consistency of UI, I didn’t use the javascript client provided by Algolia, which is implemented as autocomplete instant search.</p><script src="https://gist.github.com/artchen/231eee1223539cfdd094caa07bd6bec5.js"></script><h1 id="Enable-your-search"><a href="#Enable-your-search" class="headerlink" title="Enable your search"></a>Enable your search</h1><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> customSearch = <span class="keyword">new</span> AlgoliaSearch(&#123;</span><br><span class="line">  apiKey: ALGOLIA_API_KEY,</span><br><span class="line">  appId: ALGOLIA_APP_ID,</span><br><span class="line">  indexName: ALGOLIA_INDEX_NAME</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;This is the 4th article in a series that covers the steps to add searching to &lt;a href=&quot;http://ghost.org&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;G
      
    
    </summary>
    
    
    
      <category term="Ghost" scheme="http://artifact.me/tags/ghost/"/>
    
      <category term="Hexo" scheme="http://artifact.me/tags/hexo/"/>
    
      <category term="Search" scheme="http://artifact.me/tags/search/"/>
    
      <category term="API" scheme="http://artifact.me/tags/api/"/>
    
  </entry>
  
  <entry>
    <title>Universal Search #3 Hexo Local Search</title>
    <link href="http://artifact.me/universal-search-3-hexo-local-search/"/>
    <id>http://artifact.me/universal-search-3-hexo-local-search/</id>
    <published>2016-09-01T04:54:58.000Z</published>
    <updated>2020-04-05T01:55:34.059Z</updated>
    
    <content type="html"><![CDATA[<p>This is the 3rd article in a series that covers the steps to add searching to <a href="http://ghost.org" target="_blank" rel="noopener">Ghost</a>, <a href="http://hexo.io" target="_blank" rel="noopener">Hexo</a> or any general website using APIs provided by various services.</p><p>The latest version of Universal Search is available on Github at <a href="https://github.com/artchen/universal-search" target="_blank" rel="noopener">https://github.com/artchen/universal-search</a>.</p><p>We have covered UI and common logics in <a href="/universal-search-1-common-logic/">the first article</a>. This time we are going to explore Hexo local search. If you website is not generated by Hexo, you don’t necessarily need to read this article.</p><h1 id="Basic-Idea"><a href="#Basic-Idea" class="headerlink" title="Basic Idea"></a>Basic Idea</h1><p>Static site generator like Hexo does not rely on any database. Instead they pre-generate all pages and save them as individual html files. If we want to add search ability without using 3rd-party services, we will have to generate the “database” ourselves. In this case, the “database” is a index file that contains essential information of pages and posts. When the user submit a search request, the front-end javascript will download this index file, and searching for relevant items.</p><h1 id="Generate-Index-File"><a href="#Generate-Index-File" class="headerlink" title="Generate Index File"></a>Generate Index File</h1><p>There are several Hexo generators that does this for us. I use <a href="https://github.com/alexbruno/hexo-generator-json-content" target="_blank" rel="noopener">hexo-generator-json-content</a> by <a href="https://github.com/alexbruno" target="_blank" rel="noopener">alexbruno</a> for this project.</p><p>To install this plugin, first navigate to your Hexo directory, then</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-generator-json-content</span><br></pre></td></tr></table></figure><p>Then edit the global <code>_config.yml</code>, add the following configuration:</p><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">jsonContent:</span></span><br><span class="line">  <span class="attr">meta:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">keywords:</span> <span class="literal">false</span> <span class="comment"># (english, spanish, polish, german, french, italian, dutch, russian, portuguese, swedish)</span></span><br><span class="line">  <span class="attr">pages:</span></span><br><span class="line">    <span class="attr">title:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">slug:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">date:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">updated:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">comments:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">path:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">link:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">permalink:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">excerpt:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">keywords:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">text:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">raw:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">content:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">posts:</span></span><br><span class="line">    <span class="attr">title:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">slug:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">date:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">updated:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">comments:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">path:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">link:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">permalink:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">excerpt:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">keywords:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">text:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">raw:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">content:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">tags:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><p>The plugin should be good to go. From now on, every time <code>hexo generate</code> is executed, a <code>content.json</code> file will be generated in the <code>public</code> directory.</p><h1 id="Build-the-class"><a href="#Build-the-class" class="headerlink" title="Build the class"></a>Build the class</h1><p>This section is more of a development note. Plugin users don’t have to read it.</p><p>The class for Hexo local search is similar to the one we created for <a href="/universal-search-2-google-custom-search-engine">Google Custom Search Engine</a> except this time we need a <code>contentSearch(post, queryText)</code> function to manually account for the keyword searching.</p><p>I adopted this searching algorithm from <a href="http://hahack.com/codes/local-search-engine-for-hexo/" target="_blank" rel="noopener">http://hahack.com/codes/local-search-engine-for-hexo/</a>. It was pretty simple and clean.</p><script src="https://gist.github.com/artchen/dd07cb1552e0335cdda6c9f692cbca13.js"></script><h1 id="Enable-your-search"><a href="#Enable-your-search" class="headerlink" title="Enable your search"></a>Enable your search</h1><p>Initialize an instance of the HexoSearch class:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> customSearch = <span class="keyword">new</span> HexoSearch(&#123;</span><br><span class="line">  endpoint: "&lt;path-to-your-content.json&gt;" # optional</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;This is the 3rd article in a series that covers the steps to add searching to &lt;a href=&quot;http://ghost.org&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;G
      
    
    </summary>
    
    
    
      <category term="Ghost" scheme="http://artifact.me/tags/ghost/"/>
    
      <category term="Hexo" scheme="http://artifact.me/tags/hexo/"/>
    
      <category term="Search" scheme="http://artifact.me/tags/search/"/>
    
      <category term="API" scheme="http://artifact.me/tags/api/"/>
    
  </entry>
  
  <entry>
    <title>Universal Search #2 Google Custom Search Engine</title>
    <link href="http://artifact.me/universal-search-2-google-custom-search-engine/"/>
    <id>http://artifact.me/universal-search-2-google-custom-search-engine/</id>
    <published>2016-08-30T22:55:27.000Z</published>
    <updated>2020-04-05T01:55:34.059Z</updated>
    
    <content type="html"><![CDATA[<p>This is the 2nd article in a series that covers the steps to add searching to <a href="http://ghost.org" target="_blank" rel="noopener">Ghost</a>, <a href="http://hexo.io" target="_blank" rel="noopener">Hexo</a> or any general website using APIs provided by various services.</p><p>The latest version of Universal Search is available on Github at <a href="https://github.com/artchen/universal-search" target="_blank" rel="noopener">https://github.com/artchen/universal-search</a>.</p><p>We have covered UI and common logics in <a href="/universal-search-1-common-logic/">the previous article</a>. This time we are going to integrate <a href="https://cse.google.com" target="_blank" rel="noopener">Google Custom Search Engine</a>.</p><h1 id="Get-Engine-ID"><a href="#Get-Engine-ID" class="headerlink" title="Get Engine ID"></a>Get Engine ID</h1><p>Go to <a href="https://cse.google.com" target="_blank" rel="noopener">https://cse.google.com</a>. Click the add button.</p><p><a href="https://cdn.otakism.com/images/universal-search/google/gcse-01.jpg" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/google/gcse-01.jpg" alt="gcse-01"></a></p><p>Go to next. Enter your website domain. Then click the create button.</p><p><a href="https://cdn.otakism.com/images/universal-search/google/gcse-02.jpg" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/google/gcse-02.jpg" alt="gcse-02"></a></p><p>On the congratulations screen, click Control Panel.</p><p><a href="https://cdn.otakism.com/images/universal-search/google/gcse-03.jpg" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/google/gcse-03.jpg" alt="gcse-03"></a></p><p>On the control panel, click Search Engine ID, note down the ID in the popup modal.</p><p><a href="https://cdn.otakism.com/images/universal-search/google/gcse-04.jpg" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/google/gcse-04.jpg" alt="gcse-04"></a></p><h1 id="Get-API-Key"><a href="#Get-API-Key" class="headerlink" title="Get API Key"></a>Get API Key</h1><p>Go to <a href="https://console.developers.google.com" target="_blank" rel="noopener">Google API Console</a>. You may need to register first. Click ENABLE API.</p><p><a href="https://cdn.otakism.com/images/universal-search/google/gcse-05.jpg" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/google/gcse-05.jpg" alt="gcse-05"></a></p><p>Search for “custom search”, click on the first result.</p><p><a href="https://cdn.otakism.com/images/universal-search/google/gcse-06.jpg" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/google/gcse-06.jpg" alt="gcse-06"></a></p><p>On the Custom Search API page, click on Credential in the left side bar.</p><p><a href="https://cdn.otakism.com/images/universal-search/google/gcse-07.jpg" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/google/gcse-07.jpg" alt="gcse-07"></a></p><p>On the Credential page, click create credential, then choose API Key.</p><p><a href="https://cdn.otakism.com/images/universal-search/google/gcse-08.jpg" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/google/gcse-08.jpg" alt="gcse-08"></a></p><p>On the popup modal, choose Browser key.</p><p><a href="https://cdn.otakism.com/images/universal-search/google/gcse-09.jpg" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/google/gcse-09.jpg" alt="gcse-09"></a></p><p>Name you API key and specify any URL wildcard as authorized referrers, then click create.</p><p><a href="https://cdn.otakism.com/images/universal-search/google/gcse-10.jpg" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/google/gcse-10.jpg" alt="gcse-10"></a></p><p>You will be prompted the API key.</p><p><a href="https://cdn.otakism.com/images/universal-search/google/gcse-11.jpg" target="_blank" rel="noopener"><img src="https://cdn.otakism.com/images/universal-search/google/gcse-11.jpg" alt="gcse-11"></a></p><h1 id="Build-the-class"><a href="#Build-the-class" class="headerlink" title="Build the class"></a>Build the class</h1><p>This section is more of a development note. Plugin users don’t have to read it.</p><p>The <code>GoogleCustomSearch</code> class should inherit the <code>SearchService</code> class that we built in <a href="/universal-search-0-common-logic/">the previous article</a> so that it has all the functions that control common data logics and the UI.</p><p>There are only 3 functions to customize:</p><ul><li><code>buildResultList(data)</code>: traverse the result array, pass url, title and digest to the common <code>buildResult()</code> function to generate HTML markups.</li><li><code>buildMetadata(data)</code>: generate metadata to enable pagination.</li><li><code>query(queryText, startIndex, callback)</code>: send Ajax GET request to the Google Custom Search endpoint to get search results.</li></ul><p>In detail, we coded a class like this:</p><script src="https://gist.github.com/artchen/212e08ff3ae2290c7b6c0dcfb32a407f.js"></script><h1 id="Enable-your-search"><a href="#Enable-your-search" class="headerlink" title="Enable your search"></a>Enable your search</h1><p>It should be as simple as initialize an instance of the GoogleCustomSearch class with your credentials:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> customSearch = <span class="keyword">new</span> GoogleCustomSearch(&#123;</span><br><span class="line">  apiKey: GOOGLE_CUSTOM_SEARCH_API_KEY,</span><br><span class="line">  engineId: GOOGLE_CUSTOM_SEARCH_ENGINE_ID</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;This is the 2nd article in a series that covers the steps to add searching to &lt;a href=&quot;http://ghost.org&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;G
      
    
    </summary>
    
    
    
      <category term="Ghost" scheme="http://artifact.me/tags/ghost/"/>
    
      <category term="Hexo" scheme="http://artifact.me/tags/hexo/"/>
    
      <category term="Search" scheme="http://artifact.me/tags/search/"/>
    
      <category term="API" scheme="http://artifact.me/tags/api/"/>
    
  </entry>
  
  <entry>
    <title>Universal Search #1 Common Logic</title>
    <link href="http://artifact.me/universal-search-1-common-logic/"/>
    <id>http://artifact.me/universal-search-1-common-logic/</id>
    <published>2016-08-30T21:27:59.000Z</published>
    <updated>2020-04-05T01:55:34.059Z</updated>
    
    <content type="html"><![CDATA[<p>This is the 1st article in a series that covers the steps to add searching to <a href="http://ghost.org" target="_blank" rel="noopener">Ghost</a>, <a href="http://hexo.io" target="_blank" rel="noopener">Hexo</a> or any general website using APIs provided by various services.</p><p>The goal of this series is to eventually create a javascript package that allows users to add searching to their websites by only copy-pasting code snippets and changing some configurations.</p><p>I name the series “universal search” because these techniques are meant to work on any website. In reality, some of them require additional plugins to be installed, some of them may only apply to a few platforms. What I am trying to do here is to provide as many options as possible so that users can find at least one solution that works.</p><h1 id="Before-reading"><a href="#Before-reading" class="headerlink" title="Before reading"></a>Before reading</h1><p>The latest version of Universal Search is available on Github at <a href="https://github.com/artchen/universal-search" target="_blank" rel="noopener">https://github.com/artchen/universal-search</a>, feel free to clone and install.</p><p>This article discusses my design of the plugin. If you only want to use it without knowing everything behind the scene, you can go ahead to one the of the following tutorials to setup individual search services:</p><ul><li><a href="/universal-search-2-google-custom-search-engine/">Google Custom Search Engine</a></li><li><a href="/universal-search-3-hexo-local-search">Hexo Local Search</a> - Hexo only</li><li><a href="/universal-search-4-algolia-search">Algolia Search</a></li><li><a href="/universal-search-5-azure-search">Azure Search</a></li><li><a href="/universal-search-6-baidu-search">Baidu Search</a></li></ul><h1 id="Basic-Workflow"><a href="#Basic-Workflow" class="headerlink" title="Basic Workflow"></a>Basic Workflow</h1><ul><li>Register a 3rd-party searching service, get the credentials (API Key, ID, etc).</li><li>Send Ajax GET requests to some endpoint, get response in JSON format.</li><li>Parse the response if necessary.</li><li>Render the results on UI.</li></ul><h1 id="Common-UI"><a href="#Common-UI" class="headerlink" title="Common UI"></a>Common UI</h1><p>Though I always advocate original and customized design, this time I am going to use the same common UI for some consistency. This interface is independent of whatever 3rd-party search service we choose.</p><script src="https://gist.github.com/artchen/4a961c7ac9d6b9da188868c0f29a15d4.js"></script><p>This markup will be compressed and embedded into the javascript. When the plugin is initialized, the markup will be inserted into <code>&lt;body&gt;</code>.</p><h1 id="Common-Logic"><a href="#Common-Logic" class="headerlink" title="Common Logic"></a>Common Logic</h1><p>The javascript part of universal search should take care of 3 main aspects:</p><ul><li>Query for search results.</li><li>Parse results.</li><li>Render UI.</li></ul><p>We already decided that the UI should be the same across services. So the following UI interactions should be defined as common functions.</p><ul><li><code>onSubmit(event)</code>: when the user submit the search form, open modal and query.</li><li><code>onNextPage()</code>: when the user request the next page, fetch next page.</li><li><code>onPrevPage()</code>: when the user request the previous page, fetch previous page.</li><li><code>close()</code>: when the user close the modal, fade out the modal.</li><li><code>uiBeforeQuery()</code>: hide the result container, show loading animation.</li><li><code>uiAfterQuery()</code>: hide loading animation, scroll result container to top, fade in the results.</li><li><code>startLoading()</code>: start the timer for loading bar animation.</li><li><code>stopLoading()</code>: stop the timer for loading bar animation.</li></ul><p>The query and parsing need to be defined on a per service basis because they apparently have different formats of API and response data. But we can centralize the following functions.</p><ul><li><code>onQueryError(queryText, status)</code>: empty result container, generate error messages and render in error container.</li><li><code>buildResult(url, title, digest)</code>: generate html for one result.</li></ul><p>Most importantly, there should be init() and destroy():</p><ul><li><code>destroy()</code>: unregister event handlers, clear markups.</li><li><code>init()</code>: register event handlers.</li></ul><p>All the functions listed above are common logics that goes into a super class called <code>SearchService</code>.</p><p>Here is the result:</p><script src="https://gist.github.com/artchen/a24102f119cf67e385db7cfa39a9c812.js"></script><p>These conclude the high level design and common part of universal search.</p><p>You can now proceed to one of the following articles to integrate the search service of your choice:</p><ul><li><a href="/universal-search-2-google-custom-search-engine/">Google Custom Search Engine</a></li><li><a href="/universal-search-3-hexo-local-search">Hexo Local Search</a> - Hexo only</li><li><a href="/universal-search-4-algolia-search">Algolia Search</a></li><li><a href="/universal-search-5-azure-search">Azure Search</a></li><li><a href="/universal-search-6-baidu-search">Baidu Search</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;This is the 1st article in a series that covers the steps to add searching to &lt;a href=&quot;http://ghost.org&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;G
      
    
    </summary>
    
    
    
      <category term="Ghost" scheme="http://artifact.me/tags/ghost/"/>
    
      <category term="Hexo" scheme="http://artifact.me/tags/hexo/"/>
    
      <category term="Search" scheme="http://artifact.me/tags/search/"/>
    
      <category term="API" scheme="http://artifact.me/tags/api/"/>
    
  </entry>
  
  <entry>
    <title>Hexo Theme Memory</title>
    <link href="http://artifact.me/hexo-theme-memory/"/>
    <id>http://artifact.me/hexo-theme-memory/</id>
    <published>2016-06-12T01:01:18.000Z</published>
    <updated>2020-05-03T22:47:55.785Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Memory</strong> is a minimal theme for <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>.</p><p>The theme is available on github at <a href="https://github.com/artchen/hexo-theme-memory" target="_blank" rel="noopener">https://github.com/artchen/hexo-theme-memory</a></p><p>This theme is also available on:</p><ul><li>Ghost version: <a href="https://github.com/artchen/ghost-theme-memory" target="_blank" rel="noopener">ghost-theme-memory</a></li></ul><h1 id="Dependencies"><a href="#Dependencies" class="headerlink" title="Dependencies"></a>Dependencies</h1><p>This theme depends on the following Hexo plugins to work correctly:</p><ul><li>hexo-generator-tag</li><li>hexo-renderer-ejs</li><li>hexo-renderer-less</li><li>hexo-renderer-marked</li><li>hexo-pagination</li></ul><p>Please make sure these plugins are installed before generate the site.</p><h1 id="Customization"><a href="#Customization" class="headerlink" title="Customization"></a>Customization</h1><p>The theme is customizable via <code>_config.yml</code> file under the theme directory.</p><p>The global <code>_config.yml</code> for Hexo may also be modified. In particular:</p><ul><li>Add/modify <code>disqus_shortname</code> field, the value set to your Disqus short name</li><li>Change <code>theme</code> field to <code>hexo-theme-memory</code></li></ul><p>In addition to these settings, users may also want to edit/replace the following files:</p><ul><li>Replace the site logo: <code>source/images/logo.png</code>, <code>source/images/logo.psd</code></li><li>The search feature uses <a href="https://swiftype.com/" target="_blank" rel="noopener">swiftype</a>. Please follow their instruction to setup yours.</li><li>The icon fonts are from <a href="https://icomoon.io/" target="_blank" rel="noopener">icomoon</a>.</li></ul><h1 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h1><p><img src="https://cdn.otakism.com/assets/hexo-theme-memory/demo/ghost-theme-memory-screenshot.jpg" alt="Memory Demo"></p><h1 id="Copyright"><a href="#Copyright" class="headerlink" title="Copyright"></a>Copyright</h1><p>Public resources used in this theme:</p><ul><li><a href="https://icomoon.io/" target="_blank" rel="noopener">icomoon</a></li><li><a href="https://necolas.github.io/normalize.css/" target="_blank" rel="noopener">normalize.css</a></li><li><a href="https://github.com/davatron5000/FitVids.js" target="_blank" rel="noopener">fitvids.js</a></li></ul><p>Copyright © Art Chen</p><p>Please do not remove the “Theme Memory designed by Art Chen” text and links.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;Memory&lt;/strong&gt; is a minimal theme for &lt;a href=&quot;https://hexo.io&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;The theme is avai
      
    
    </summary>
    
    
    
      <category term="Theme" scheme="http://artifact.me/tags/theme/"/>
    
      <category term="Hexo" scheme="http://artifact.me/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>Ghost Theme Memory</title>
    <link href="http://artifact.me/ghost-theme-memory/"/>
    <id>http://artifact.me/ghost-theme-memory/</id>
    <published>2016-04-23T02:49:46.000Z</published>
    <updated>2020-05-03T22:47:59.822Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Memory</strong> is a minimal theme for <a href="http://ghost.org" target="_blank" rel="noopener">Ghost</a>. I am working on a <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> version, too.</p><p>The theme is now available at <a href="https://github.com/artchen/ghost-theme-memory" target="_blank" rel="noopener">https://github.com/artchen/ghost-theme-memory</a>.</p><p>This theme is also available on:</p><ul><li>Hexo version: <a href="https://github.com/artchen/hexo-theme-memory" target="_blank" rel="noopener">hexo-theme-memory</a></li></ul><h1 id="Production"><a href="#Production" class="headerlink" title="Production"></a>Production</h1><p>If you are going to use the theme directly (without much customization).</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &lt;path-to-ghost-folder&gt;&#x2F;content&#x2F;themes&#x2F;</span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;artchen&#x2F;ghost-theme-memory.git</span><br></pre></td></tr></table></figure><p>The version shared via Github is used on <a href="https://otakism.com" target="_blank" rel="noopener">otakism.com</a>, my blog. There are quite a few things hard-coded into the template that you’ll need to customize. Including but not limited to:</p><ul><li>The site logo: <code>assets/img/logo.png</code></li><li>The short text under the logo: <code>partials/header.hbs</code></li><li>Disqus integration: <code>page.hbs</code>, <code>post.hbs</code></li><li>Social account links: <code>partials/footer.hbs</code></li></ul><p>The search feature relies on <a href="https://swiftype.com/" target="_blank" rel="noopener">swiftype</a>. Please follow their instruction to set up your own searches.</p><p>The fonts are from <a href="https://typekit.com/" target="_blank" rel="noopener">Typekit</a>. If you are not using typekit, please remove corresponding code is in <code>default.hbs</code>.</p><h1 id="Development"><a href="#Development" class="headerlink" title="Development"></a>Development</h1><p>Clone the repository.</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &lt;path-to-ghost-folder&gt;&#x2F;content&#x2F;themes&#x2F;</span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;artchen&#x2F;ghost-theme-memory.git memory</span><br></pre></td></tr></table></figure><p>Install <a href="http://gulpjs.com/" target="_blank" rel="noopener">gulp</a>, <a href="http://bower.io/" target="_blank" rel="noopener">bower</a> and <a href="https://www.npmjs.com/" target="_blank" rel="noopener">npm</a> before proceed.</p><p>Install and build the app:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd .&#x2F;ghost-theme-memory</span><br><span class="line">npm install</span><br><span class="line">bower install</span><br><span class="line">gulp</span><br></pre></td></tr></table></figure><p>At this point your development environment is ready.</p><h1 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h1><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">cd &lt;path-to-ghost&gt;&#x2F;content&#x2F;themes&#x2F;ghost-theme-memory&#x2F;</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure><h1 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h1><p>Visit my blog (in Chinese) for a demo of tis theme. <a href="https://otakism.org" target="_blank" rel="noopener">http://otakism.org</a>.</p><h1 id="Screenshot"><a href="#Screenshot" class="headerlink" title="Screenshot"></a>Screenshot</h1><p><img src="https://cdn.otakism.com/assets/hexo-theme-memory/demo/ghost-theme-memory-screenshot.jpg" alt="Memory Screenshot"></p><h1 id="Copyright"><a href="#Copyright" class="headerlink" title="Copyright"></a>Copyright</h1><p>Public resources used in this theme:</p><ul><li><a href="https://icomoon.io/" target="_blank" rel="noopener">icomoon</a></li><li><a href="https://necolas.github.io/normalize.css/" target="_blank" rel="noopener">normalize.css</a></li></ul><p>Copyright © Art Chen</p><p>Please do not remove the “Theme Memory designed by Art Chen” text and links.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;Memory&lt;/strong&gt; is a minimal theme for &lt;a href=&quot;http://ghost.org&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Ghost&lt;/a&gt;. I am working on a &lt;a 
      
    
    </summary>
    
    
    
      <category term="Ghost" scheme="http://artifact.me/tags/ghost/"/>
    
      <category term="Theme" scheme="http://artifact.me/tags/theme/"/>
    
  </entry>
  
  <entry>
    <title>Simple Gulp Configuration for Angular Applications</title>
    <link href="http://artifact.me/simple-gulp-configuration-for-angular-applications/"/>
    <id>http://artifact.me/simple-gulp-configuration-for-angular-applications/</id>
    <published>2016-03-12T04:54:24.000Z</published>
    <updated>2020-04-05T01:55:34.059Z</updated>
    
    <content type="html"><![CDATA[<p><a href="http://gulpjs.com/" target="_blank" rel="noopener">Gulp</a> is a great build tool for web applications. In this article I am sharing some gulp scripts that I found really useful.</p><h1 id="Installing-Gulp"><a href="#Installing-Gulp" class="headerlink" title="Installing Gulp"></a>Installing Gulp</h1><p><a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node.js</a> needs to be installed prior to installing gulp. Once Node.js is ready on your machine, run this command to install gulp:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo npm install --global gulp-cli</span><br></pre></td></tr></table></figure><p>This will install the gulp command line tools globally, such that the <code>gulp</code> command can be invoked throughout the computer.</p><h1 id="Create-a-Gulp-Project"><a href="#Create-a-Gulp-Project" class="headerlink" title="Create a Gulp Project"></a>Create a Gulp Project</h1><p>Change directory to the project’s root.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm init</span><br></pre></td></tr></table></figure><p>First of all, initialize npm, set the project name, version, author, etc. After the setup, <code>package.json</code> will be created.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install gulp --save-dev</span><br></pre></td></tr></table></figure><p>Install gulp for the project. <code>--save-dev</code> make sure that gulp is logged in <code>package.json</code> as a development dependency. This is particularly useful when we need to port the project to another computer. With all the dependencies logged in package.json, we just run <code>npm install</code> to get them back, instead of install each of them again, or copy the gaint node_modules folder around.</p><h1 id="Project-Structure"><a href="#Project-Structure" class="headerlink" title="Project Structure"></a>Project Structure</h1><p>For an Angular.js application with gulp as the build tool, I usually setup the project directory like this:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">|- project&#x2F;                </span><br><span class="line">  |- bower_components&#x2F;</span><br><span class="line">  |- dist&#x2F;</span><br><span class="line">  |- node_modules&#x2F;    </span><br><span class="line">  |- src&#x2F;</span><br><span class="line">    |- css&#x2F;              # vendor css</span><br><span class="line">    |- less&#x2F;             # my less source code</span><br><span class="line">    |- img&#x2F;</span><br><span class="line">    |- js&#x2F;               # my javascript source code</span><br><span class="line">    |- vendor&#x2F;           # vendor js</span><br><span class="line">    |- views&#x2F;            # angular templates</span><br><span class="line">    |- index.html</span><br><span class="line">  |- bower.json</span><br><span class="line">  |- gulpfile.js</span><br><span class="line">  |- package.json</span><br></pre></td></tr></table></figure><h1 id="A-simple-gulpfile-js"><a href="#A-simple-gulpfile-js" class="headerlink" title="A simple gulpfile.js"></a>A simple gulpfile.js</h1><p>Here comes the fun part. A basic gulpfile looks like this:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// require gulp dependencies</span></span><br><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// declare a gulp task</span></span><br><span class="line">gulp.task(<span class="string">'task_name'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// task pipelines</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>The tasks can be run in command line like:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gulp task_name</span><br></pre></td></tr></table></figure><h1 id="Define-Paths"><a href="#Define-Paths" class="headerlink" title="Define Paths"></a>Define Paths</h1><p>Define a path object to keep track of all the source code in the project, making it easier for reference in various gulp tasks. For one of the angularjs application, I had the following paths:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> path = &#123;</span><br><span class="line">  <span class="comment">// template markups</span></span><br><span class="line">  HTML: [</span><br><span class="line">    <span class="string">'src/*.html'</span>,</span><br><span class="line">    <span class="string">'src/views/**/*.html'</span>,</span><br><span class="line">    <span class="string">'src/views/*.html'</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// my js source code</span></span><br><span class="line">  JS: [</span><br><span class="line">    <span class="string">'src/js/**/*.js'</span></span><br><span class="line">    <span class="string">'src/js/*.js'</span>,</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// all less files (for changes monitoring purpose)</span></span><br><span class="line">  LESS_ALL: [</span><br><span class="line">    <span class="string">'src/less/*.less'</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// main less file (others are imported in style.less)</span></span><br><span class="line">  LESS: [</span><br><span class="line">    <span class="string">'src/less/style.less'</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// images</span></span><br><span class="line">  IMG: [</span><br><span class="line">    <span class="string">'src/img/**'</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// vendor css</span></span><br><span class="line">  CSS: [</span><br><span class="line">    <span class="string">'src/css/*.css'</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// vendor js</span></span><br><span class="line">  VENDOR: [</span><br><span class="line">    <span class="string">'bower_components/angular/angular.js'</span>,</span><br><span class="line">    <span class="string">'bower_components/angular-animate/angular-aria.js'</span>,</span><br><span class="line">    <span class="comment">// ...and more</span></span><br><span class="line">  ],</span><br><span class="line">  DIST: [</span><br><span class="line">    <span class="string">'./dist'</span></span><br><span class="line">  ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="Installing-Gulp-Plugins"><a href="#Installing-Gulp-Plugins" class="headerlink" title="Installing Gulp Plugins"></a>Installing Gulp Plugins</h1><p>There are tons of useful gulp plugins to explore. Gulp plugins can be installed by</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install &lt;plugin-name&gt; --save-dev</span><br></pre></td></tr></table></figure><p>For example, to install <code>gulp-connect</code>:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install gulp-connect --save-dev</span><br></pre></td></tr></table></figure><h1 id="Useful-Gulp-Tasks"><a href="#Useful-Gulp-Tasks" class="headerlink" title="Useful Gulp Tasks"></a>Useful Gulp Tasks</h1><p>Here I only introduce some gulp tasks that I found helpful in angularjs development.</p><p>Spin up a erver for <code>dist</code>.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> connect = <span class="built_in">require</span>(<span class="string">'gulp-connect'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  connect.server(&#123;</span><br><span class="line">    root: <span class="string">'dist'</span>,</span><br><span class="line">    port: <span class="number">4000</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>Clean up distribution directory.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> connect = <span class="built_in">require</span>(<span class="string">'gulp-clean'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'clean'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(<span class="string">'./dist/*'</span>, &#123;<span class="attr">force</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">    .pipe(clean());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>Use JSLint.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> jshint = <span class="built_in">require</span>(<span class="string">'gulp-jshint'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'lint'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(path.JS)</span><br><span class="line">    .pipe(jshint())</span><br><span class="line">    .pipe(jshint.reporter(<span class="string">'default'</span>))</span><br><span class="line">    .pipe(jshint.reporter(<span class="string">'fail'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>Copy over CSS and HTML</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">gulp.task(<span class="string">'css'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  gulp.src(path.CSS)</span><br><span class="line">    .pipe(gulp.dest(path.DIST + <span class="string">'/css'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'html'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  gulp.src(path.HTML, &#123;<span class="attr">base</span>: <span class="string">'src'</span>&#125;)</span><br><span class="line">    .pipe(gulp.dest(path.DIST));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>Compile, minify and copy Less.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> less = <span class="built_in">require</span>(<span class="string">'gulp-less'</span>);</span><br><span class="line"><span class="keyword">var</span> lessDependents = <span class="built_in">require</span>(<span class="string">'gulp-less-dependents'</span>);</span><br><span class="line"><span class="keyword">var</span> minifyCSS = <span class="built_in">require</span>(<span class="string">'gulp-minify-css'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'less'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  gulp.src(path.LESS)</span><br><span class="line">  .pipe(lessDependents())</span><br><span class="line">    .pipe(less())</span><br><span class="line">    .pipe(minifyCSS())</span><br><span class="line">    .pipe(gulp.dest(path.DIST + <span class="string">'/css'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>Merge, uglify and copy js files.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> concat = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>);</span><br><span class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);</span><br><span class="line"><span class="keyword">var</span> ngAnnotate = <span class="built_in">require</span>(<span class="string">'gulp-ng-annotate'</span>);</span><br><span class="line"><span class="keyword">var</span> sourcemaps = <span class="built_in">require</span>(<span class="string">'gulp-sourcemaps'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'js'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  gulp.src(path.JS)</span><br><span class="line">  .pipe(sourcemaps.init())</span><br><span class="line">  .pipe(concat(<span class="string">'app.js'</span>))</span><br><span class="line">  .pipe(ngAnnotate())</span><br><span class="line">  .pipe(uglify())</span><br><span class="line">.pipe(sourcemaps.write())</span><br><span class="line">    .pipe(gulp.dest(path.DIST + <span class="string">'/js'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'vendor'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">gulp.src(path.VENDOR)</span><br><span class="line">.pipe(concat(<span class="string">'vendor.js'</span>))</span><br><span class="line">.pipe(ngAnnotate())</span><br><span class="line">.pipe(uglify())</span><br><span class="line">    .pipe(gulp.dest(path.DIST + <span class="string">'/js'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>Compress images.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> imagemin = <span class="built_in">require</span>(<span class="string">'gulp-imagemin'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'img'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  gulp.src(path.IMG)</span><br><span class="line">    .pipe(imagemin())</span><br><span class="line">    .pipe(gulp.dest(path.DIST + <span class="string">'/img'</span>));</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>Watch changes and automate tasks.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> watch = <span class="built_in">require</span>(<span class="string">'gulp-watch'</span>);</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'watch'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  gulp.watch(path.LESS_ALL, [<span class="string">'less'</span>]);</span><br><span class="line">  gulp.watch(path.VENDOR, [<span class="string">'vendor'</span>]);</span><br><span class="line">  gulp.watch(path.JS, [<span class="string">'lint'</span>, <span class="string">'js'</span>]);</span><br><span class="line">  gulp.watch(path.HTML, [<span class="string">'html'</span>]);</span><br><span class="line">  gulp.watch(path.IMG, [<span class="string">'img'</span>]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>Default task.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> all_tasks = [<span class="string">'lint'</span>, <span class="string">'css'</span>, <span class="string">'less'</span>, <span class="string">'vendor'</span>, <span class="string">'js'</span>, <span class="string">'html'</span>, <span class="string">'img'</span>];</span><br><span class="line"></span><br><span class="line">gulp.task(<span class="string">'default'</span>, all_tasks);</span><br></pre></td></tr></table></figure><h1 id="A-More-Complete-gulpfile-js"><a href="#A-More-Complete-gulpfile-js" class="headerlink" title="A More Complete gulpfile.js"></a>A More Complete gulpfile.js</h1><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* gulp dependencies */</span></span><br><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> less = <span class="built_in">require</span>(<span class="string">'gulp-less'</span>);</span><br><span class="line"><span class="keyword">var</span> watch = <span class="built_in">require</span>(<span class="string">'gulp-watch'</span>);</span><br><span class="line"><span class="keyword">var</span> imagemin = <span class="built_in">require</span>(<span class="string">'gulp-imagemin'</span>);</span><br><span class="line"><span class="keyword">var</span> connect = <span class="built_in">require</span>(<span class="string">'gulp-connect'</span>);</span><br><span class="line"><span class="keyword">var</span> concat = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>);</span><br><span class="line"><span class="keyword">var</span> sourcemaps = <span class="built_in">require</span>(<span class="string">'gulp-sourcemaps'</span>);</span><br><span class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);</span><br><span class="line"><span class="keyword">var</span> ngAnnotate = <span class="built_in">require</span>(<span class="string">'gulp-ng-annotate'</span>);</span><br><span class="line"><span class="keyword">var</span> minifyCSS = <span class="built_in">require</span>(<span class="string">'gulp-minify-css'</span>);</span><br><span class="line"><span class="keyword">var</span> lessDependents = <span class="built_in">require</span>(<span class="string">'gulp-less-dependents'</span>);</span><br><span class="line"><span class="keyword">var</span> clean = <span class="built_in">require</span>(<span class="string">'gulp-clean'</span>);</span><br><span class="line"><span class="keyword">var</span> bower = <span class="built_in">require</span>(<span class="string">'gulp-bower'</span>);</span><br><span class="line"><span class="keyword">var</span> concat_vendor = <span class="built_in">require</span>(<span class="string">'gulp-concat-vendor'</span>);</span><br><span class="line"><span class="keyword">var</span> jshint = <span class="built_in">require</span>(<span class="string">'gulp-jshint'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* path def */</span></span><br><span class="line"><span class="keyword">var</span> path = &#123;</span><br><span class="line">  HTML: [</span><br><span class="line">  <span class="string">'src/.htaccess'</span>, </span><br><span class="line">  <span class="string">'src/*.html'</span>, </span><br><span class="line">  <span class="string">'src/views/**/*.html'</span>, </span><br><span class="line">  <span class="string">'src/views/*.html'</span>, </span><br><span class="line">  <span class="string">'src/favicon.png'</span></span><br><span class="line">  ],</span><br><span class="line">  JS: [</span><br><span class="line">  <span class="string">'src/js/*.js'</span>, </span><br><span class="line">  <span class="string">'src/js/**/*.js'</span></span><br><span class="line">  ],</span><br><span class="line">  CSS: [</span><br><span class="line">  <span class="string">'src/css/*.css'</span></span><br><span class="line">  ],</span><br><span class="line">  LESS: [</span><br><span class="line">  <span class="string">'src/less/style.less'</span></span><br><span class="line">  ],</span><br><span class="line">  LESS_ALL: [</span><br><span class="line">  <span class="string">'src/less/*.less'</span></span><br><span class="line">  ], </span><br><span class="line">  IMG: [</span><br><span class="line">  <span class="string">'src/img/**'</span></span><br><span class="line">  ],</span><br><span class="line">  VENDOR: [</span><br><span class="line">  <span class="string">'bower_components/angular/angular.js'</span>, </span><br><span class="line"><span class="string">'bower_components/angular-animate/angular-animate.js'</span>, </span><br><span class="line"><span class="string">'bower_components/angular-aria/angular-aria.js'</span>, </span><br><span class="line"><span class="string">'bower_components/angular-messages/angular-messages.js'</span>,</span><br><span class="line"><span class="string">'bower_components/angular-sanitize/angular-sanitize.js'</span>,  </span><br><span class="line"><span class="string">'bower_components/angular-ui-router/release/angular-ui-router.js'</span></span><br><span class="line">    <span class="comment">// ...and more</span></span><br><span class="line">],</span><br><span class="line">  DIST: <span class="string">'./dist'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* spin up distribution server */</span></span><br><span class="line">gulp.task(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">connect.server(&#123;</span><br><span class="line">root: <span class="string">'dist'</span>,</span><br><span class="line">port: <span class="number">4005</span></span><br><span class="line">&#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* clean up dist dir */</span></span><br><span class="line">gulp.task(<span class="string">'clean'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">return</span> gulp.src(<span class="string">'./dist/*'</span>, &#123;<span class="attr">force</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">.pipe(clean());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* jslint for debugging */</span></span><br><span class="line">gulp.task(<span class="string">'lint'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> gulp.src(path.JS)</span><br><span class="line">    .pipe(jshint())</span><br><span class="line">    .pipe(jshint.reporter(<span class="string">'default'</span>))</span><br><span class="line">    .pipe(jshint.reporter(<span class="string">'fail'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* move css */</span></span><br><span class="line">gulp.task(<span class="string">'css'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  gulp.src(path.CSS)</span><br><span class="line">    .pipe(gulp.dest(path.DIST + <span class="string">'/css'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* compile less */</span></span><br><span class="line">gulp.task(<span class="string">'less'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  gulp.src(path.LESS)</span><br><span class="line">  .pipe(lessDependents())</span><br><span class="line">    .pipe(less())</span><br><span class="line">    .pipe(minifyCSS())</span><br><span class="line">    .pipe(gulp.dest(path.DIST + <span class="string">'/css'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* concat and compress app scripts */</span></span><br><span class="line">gulp.task(<span class="string">'js'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  gulp.src(path.JS)</span><br><span class="line">  .pipe(sourcemaps.init())</span><br><span class="line">  .pipe(concat(<span class="string">'app.js'</span>))</span><br><span class="line">  .pipe(ngAnnotate())</span><br><span class="line">  .pipe(uglify())</span><br><span class="line">.pipe(sourcemaps.write())</span><br><span class="line">    .pipe(gulp.dest(path.DIST + <span class="string">'/js'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* concat vendor dependencies */</span></span><br><span class="line">gulp.task(<span class="string">'vendor'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">gulp.src(path.VENDOR)</span><br><span class="line">.pipe(concat(<span class="string">'vendor.js'</span>))</span><br><span class="line">.pipe(ngAnnotate())</span><br><span class="line">.pipe(uglify())</span><br><span class="line">    .pipe(gulp.dest(path.DIST + <span class="string">'/js'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* copy over markups */</span></span><br><span class="line">gulp.task(<span class="string">'html'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  gulp.src(path.HTML, &#123;<span class="attr">base</span>: <span class="string">'src'</span>&#125;)</span><br><span class="line">    .pipe(gulp.dest(path.DIST));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* compress images */</span></span><br><span class="line">gulp.task(<span class="string">'img'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  gulp.src(path.IMG)</span><br><span class="line">    .pipe(imagemin())</span><br><span class="line">    .pipe(gulp.dest(path.DIST + <span class="string">'/img'</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* watch all changes */</span></span><br><span class="line">gulp.task(<span class="string">'watch'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  gulp.watch(path.LESS_ALL, [<span class="string">'less'</span>]);</span><br><span class="line">  gulp.watch(path.VENDOR, [<span class="string">'vendor'</span>]);</span><br><span class="line">  gulp.watch(path.JS, [<span class="string">'lint'</span>, <span class="string">'js'</span>]);</span><br><span class="line">  gulp.watch(path.HTML, [<span class="string">'html'</span>]);</span><br><span class="line">  gulp.watch(path.IMG, [<span class="string">'img'</span>]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* defualt */</span></span><br><span class="line">gulp.task(<span class="string">'default'</span>, all_tasks);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;http://gulpjs.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Gulp&lt;/a&gt; is a great build tool for web applications. In this article I am sha
      
    
    </summary>
    
    
    
      <category term="Gulp" scheme="http://artifact.me/tags/gulp/"/>
    
  </entry>
  
  <entry>
    <title>Create Virtual Hosts on MAMP</title>
    <link href="http://artifact.me/create-virtual-hosts-on-mamp/"/>
    <id>http://artifact.me/create-virtual-hosts-on-mamp/</id>
    <published>2016-01-17T09:38:49.000Z</published>
    <updated>2020-04-05T01:55:34.058Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.mamp.info/en/" target="_blank" rel="noopener">MAMP</a> is a great GUI tool for creating server on localhost. But the free virsion of it only has very basic configurations. For example, creating a virtual host is not included. So I have to write the configurations on my own.</p><p>This article is based on Windows OS. Setup on Mac OS should be similar.</p><h1 id="Why-Virtual-Hosts"><a href="#Why-Virtual-Hosts" class="headerlink" title="Why Virtual Hosts"></a>Why Virtual Hosts</h1><p>Question: Why do we need to virtual hosts anyway? Answer: it simplifies your testing and developing. When developing a website, I want to visit it via something like <code>http://test.local</code>, rather than <code>http://localhost/test/</code>. The benefit of the former option is not just that it looks more like a real URL, or it is shorter. By creating <code>test.local</code> as the local domain, the root directory for your site is configured to any location your would like it to be, so there is no more hazard of nested path.</p><h1 id="Modify-Hosts"><a href="#Modify-Hosts" class="headerlink" title="Modify Hosts"></a>Modify Hosts</h1><p>First, add the desired domain to the system’s host file. It is located at <code>C:\Windows\System32\drivers\etc\hosts</code>.</p><p>Add this line:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">127.0.0.1test.local</span><br></pre></td></tr></table></figure><p>You can replace <code>test.local</code> with almost anything of your choice.</p><h1 id="Modify-Apache-Configuration"><a href="#Modify-Apache-Configuration" class="headerlink" title="Modify Apache Configuration"></a>Modify Apache Configuration</h1><p>Modify <code>C:\MAMP\conf\apache\httpd.conf</code>.</p><p>Find this line:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Virtual Hosts</span><br><span class="line"># Include &#x2F;Applications&#x2F;MAMP&#x2F;conf&#x2F;apache&#x2F;extra&#x2F;httpd-vhosts.conf</span><br></pre></td></tr></table></figure><p>Change it to</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># Virtual Hosts</span><br><span class="line">Include C:\MAMP\conf\apache\httpd-vhosts.conf</span><br></pre></td></tr></table></figure><h1 id="Create-Virtual-Host-Configuration"><a href="#Create-Virtual-Host-Configuration" class="headerlink" title="Create Virtual Host Configuration"></a>Create Virtual Host Configuration</h1><p>Now create the configuration file <code>httpd-vhosts.conf</code>.</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">NameVirtualHost *:80</span><br><span class="line"></span><br><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">    DocumentRoot &#39;C:\MAMP\htdocs&#39;</span><br><span class="line">    ServerName localhost</span><br><span class="line">&lt;&#x2F;VirtualHost&gt;</span><br><span class="line"> </span><br><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">    DocumentRoot &#39;C:\MAMP\htdocs\test&#39;</span><br><span class="line">    ServerName test.local</span><br><span class="line">&lt;&#x2F;VirtualHost&gt;</span><br></pre></td></tr></table></figure><p>Start MAMP, your site should be available at <code>http://test.local</code>.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://www.mamp.info/en/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;MAMP&lt;/a&gt; is a great GUI tool for creating server on localhost. But the
      
    
    </summary>
    
    
    
      <category term="MAMP" scheme="http://artifact.me/tags/mamp/"/>
    
      <category term="Apache" scheme="http://artifact.me/tags/apache/"/>
    
  </entry>
  
  <entry>
    <title>Serve Ghost and Nginx on Ubuntu 14.04 LTS</title>
    <link href="http://artifact.me/serve-ghost-and-nginx-on-ubuntu-14-04-lts/"/>
    <id>http://artifact.me/serve-ghost-and-nginx-on-ubuntu-14-04-lts/</id>
    <published>2016-01-10T08:00:00.000Z</published>
    <updated>2020-04-05T01:55:34.059Z</updated>
    
    <content type="html"><![CDATA[<p>Recently I switched from <a href="https://www.linode.com/" target="_blank" rel="noopener">Linode</a> to <a href="https://www.digitalocean.com/" target="_blank" rel="noopener">DigitalOcean</a> because of some rumor that Linode website is blocked in China. Here is a memo of how I migrated a Ghost blog, <a href="http://otakism.org" target="_blank" rel="noopener">otakism.org</a>.</p><p>Some content came from several tutorials from DigitalOcean community. Credits are given at the end of this article.</p><h1 id="Install-Nginx"><a href="#Install-Nginx" class="headerlink" title="Install Nginx"></a>Install Nginx</h1><p>Install Nginx via <code>apt-get</code>.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install nginx</span><br></pre></td></tr></table></figure><h1 id="Create-Site-Directories"><a href="#Create-Site-Directories" class="headerlink" title="Create Site Directories"></a>Create Site Directories</h1><p>I prefer <code>/var/www</code> as the root directory. To do that I created the following folders to hold my website files.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo mkdir -p /var/www/rakugaki.me/html</span><br><span class="line">sudo mkdir -p /var/www/otakism.org/html</span><br><span class="line">sudo chown -R <span class="variable">$USER</span>:<span class="variable">$USER</span> /var/www/rakugaki.me/html</span><br><span class="line">sudo chown -R <span class="variable">$USER</span>:<span class="variable">$USER</span> /var/www/otakism.org/html</span><br><span class="line">sudo chmod -R 755 /var/www</span><br></pre></td></tr></table></figure><h1 id="Create-Server-Block-Files"><a href="#Create-Server-Block-Files" class="headerlink" title="Create Server Block Files"></a>Create Server Block Files</h1><p>Server blocks configure ports and root directories for each website, as well as details about how they should be served.</p><p>Here I used <a href="http://rakugaki.me" target="_blank" rel="noopener">rakugaki.me</a> as the default domain of my server.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo cp /etc/nginx/sites-available/default /etc/nginx/sites-available/rakugaki.me</span><br><span class="line">sudo vim /etc/nginx/sites-available/rakugaki.me</span><br></pre></td></tr></table></figure><p>Change the configuration like this:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80 default_server;</span><br><span class="line">    listen [::]:80 default_server ipv6only&#x3D;on;</span><br><span class="line"></span><br><span class="line">    root &#x2F;var&#x2F;www&#x2F;rakugaki.me&#x2F;html;</span><br><span class="line">    index index.html index.htm;</span><br><span class="line"></span><br><span class="line">    server_name rakugaki.me, www.rakugaki.me;</span><br><span class="line"></span><br><span class="line">    location &#x2F; &#123;</span><br><span class="line">        try_files $uri $uri&#x2F; &#x3D;404;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Then I created the second server block file for <a href="http://otakism.org" target="_blank" rel="noopener">otakism.org</a>. Since it is a Ghost blog, the file should be like this:</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    listen [::]:80;</span><br><span class="line">    server_name otakism.org;</span><br><span class="line">    location &#x2F; &#123;</span><br><span class="line">        proxy_set_header   X-Real-IP $remote_addr;</span><br><span class="line">        proxy_set_header   Host      $http_host;</span><br><span class="line">        proxy_pass         http:&#x2F;&#x2F;127.0.0.1:2368;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>The files are done but we are not done. Enable the server block files.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo ln -s /etc/nginx/sites-available/rakugaki.me /etc/nginx/sites-enabled/</span><br><span class="line">sudo ln -s /etc/nginx/sites-available/otakism.org /etc/nginx/sites-enabled/</span><br></pre></td></tr></table></figure><p>Delete the default site generated by Nginx.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo rm /etc/nginx/sites-enabled/default</span><br></pre></td></tr></table></figure><p>Restart Nginx to apply new settings.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo service nginx restart</span><br></pre></td></tr></table></figure><h1 id="Install-Ghost"><a href="#Install-Ghost" class="headerlink" title="Install Ghost"></a>Install Ghost</h1><p>Prerequisites first. Ghost requires <a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node.js</a> and <a href="https://www.npmjs.com/" target="_blank" rel="noopener">npm</a>. These can be installed in various ways. Refer to <a href="https://www.digitalocean.com/community/tutorials/how-to-create-a-blog-with-ghost-and-nginx-on-ubuntu-14-04" target="_blank" rel="noopener">this article</a> for more options.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install nodejs</span><br><span class="line">sudo apt-get install npm</span><br></pre></td></tr></table></figure><p>Download Ghost. Details about the remaining steps in this chapter can be found in the <a href="http://support.ghost.org/installing-ghost-linux/" target="_blank" rel="noopener">official guide</a> at Ghost.org.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install zip wget</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /var/www/otakism.org/html</span><br><span class="line">sudo wget https://ghost.org/zip/ghost-latest.zip</span><br><span class="line">sudo unzip -d ghost ghost-latest.zip</span><br></pre></td></tr></table></figure><p>Install it.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> ghost/</span><br><span class="line">sudo npm install --production</span><br></pre></td></tr></table></figure><h1 id="Configure-Ghost"><a href="#Configure-Ghost" class="headerlink" title="Configure Ghost"></a>Configure Ghost</h1><p>Change the url and/or port under production section.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo cp config.example.js config.js</span><br><span class="line">sudo vim config.js</span><br></pre></td></tr></table></figure><p>I also needed to migrate data, images and themes. Copy or replace them under <code>content/</code>.</p><h1 id="Keep-Ghost-Running"><a href="#Keep-Ghost-Running" class="headerlink" title="Keep Ghost Running"></a>Keep Ghost Running</h1><p>Create upstart configurations to make the ghost blog start on system boot. In this way I can also manage my ghost blog as a service.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo /etc/init/vim ghost-otakism.conf</span><br></pre></td></tr></table></figure><p>Paste the following lines.</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># ghost-otakism</span><br><span class="line"></span><br><span class="line">start on startup</span><br><span class="line"></span><br><span class="line">script</span><br><span class="line">    cd &#x2F;var&#x2F;www&#x2F;otakism.org&#x2F;html&#x2F;ghost</span><br><span class="line">    npm start --production</span><br><span class="line">end script</span><br></pre></td></tr></table></figure><p>Finally I can summon my ghost.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo service ghost-otakism start</span><br></pre></td></tr></table></figure><p>Contents about Nginx setup credits to Justin Ellingwood, original post at <a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-nginx-server-blocks-virtual-hosts-on-ubuntu-14-04-lts" target="_blank" rel="noopener">How To Set Up Nginx Server Blocks (Virtual Hosts) on Ubuntu 14.04 LTS</a>.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Recently I switched from &lt;a href=&quot;https://www.linode.com/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Linode&lt;/a&gt; to &lt;a href=&quot;https://www.digitalocean
      
    
    </summary>
    
    
    
      <category term="Ghost" scheme="http://artifact.me/tags/ghost/"/>
    
      <category term="Nginx" scheme="http://artifact.me/tags/nginx/"/>
    
      <category term="Ubuntu" scheme="http://artifact.me/tags/ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>Ruby on Rails Configuration on Mac OS X 10.11</title>
    <link href="http://artifact.me/ruby-on-rails-config-mac/"/>
    <id>http://artifact.me/ruby-on-rails-config-mac/</id>
    <published>2015-12-25T08:00:00.000Z</published>
    <updated>2020-04-05T01:55:34.059Z</updated>
    
    <content type="html"><![CDATA[<p>This is a memo of how to setup <a href="http://rubyonrails.org/" target="_blank" rel="noopener">Ruby-on-Rails</a> on Mac OS X 10.11. Especially, to get it work on <a href="https://www.jetbrains.com/ruby/" target="_blank" rel="noopener">RubyMine 8.0.3</a>.</p><p>The following process might not be the solution for everyone.</p><a id="more"></a><h1 id="Command-Line-Tools"><a href="#Command-Line-Tools" class="headerlink" title="Command-Line Tools"></a>Command-Line Tools</h1><p>First of all, make sure developer command-line tools is installed.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">xcode-select --install</span><br></pre></td></tr></table></figure><p>If it is already installed, expected output should be:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">xcode-select: error: <span class="built_in">command</span> line tools are already installed, use <span class="string">"Software Update"</span> to install updates</span><br></pre></td></tr></table></figure><h1 id="Homebrew"><a href="#Homebrew" class="headerlink" title="Homebrew"></a>Homebrew</h1><p>Install <a href="http://brew.sh/" target="_blank" rel="noopener">Homebrew</a>:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ruby -e <span class="string">"<span class="variable">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)</span>"</span></span><br></pre></td></tr></table></figure><p>Mac OS X 10.11 comes with version 2.0.0 of Ruby so this command should work.</p><p>Then we can install almost all the packages we need via homebrew.</p><h1 id="Ruby"><a href="#Ruby" class="headerlink" title="Ruby"></a>Ruby</h1><p>Use the officially recommended way to manage ruby versions with rbenv.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew install rbenv ruby-build</span><br><span class="line">rbenv install 2.2.4</span><br><span class="line">rbenv global 2.2.4</span><br></pre></td></tr></table></figure><p>Check version:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ruby -v</span><br></pre></td></tr></table></figure><h1 id="Dependencies"><a href="#Dependencies" class="headerlink" title="Dependencies"></a>Dependencies</h1><p>If I remember correctly.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">brew update</span><br><span class="line">brew upgrade</span><br><span class="line">brew install libxml2 libxslt libiconv</span><br><span class="line">gem install nokogiri -- --use-system-libraries --with-xml2-include=/usr/include/libxml2 --with-xml2-lib=/usr/lib/</span><br><span class="line">brew install mysql</span><br><span class="line">gem install mysql</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;This is a memo of how to setup &lt;a href=&quot;http://rubyonrails.org/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Ruby-on-Rails&lt;/a&gt; on Mac OS X 10.11. Especially, to get it work on &lt;a href=&quot;https://www.jetbrains.com/ruby/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;RubyMine 8.0.3&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;The following process might not be the solution for everyone.&lt;/p&gt;
    
    </summary>
    
    
    
      <category term="Ruby-on-Rails" scheme="http://artifact.me/tags/ruby-on-rails/"/>
    
  </entry>
  
  <entry>
    <title>Hexo Theme Fact</title>
    <link href="http://artifact.me/hexo-theme-fact/"/>
    <id>http://artifact.me/hexo-theme-fact/</id>
    <published>2015-11-13T08:00:00.000Z</published>
    <updated>2020-04-05T01:55:34.058Z</updated>
    
    <content type="html"><![CDATA[<p><strong>Fact</strong> is a simple but powerful theme for <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>. It comes with integration of tags, categories, archive and table-of-contents. The style design is inspired by <a href="https://www.v2ex.com/" target="_blank" rel="noopener">V2EX</a>.</p><p>The theme is available on my Github as a public repository <a href="https://github.com/artchen/hexo-theme-fact" target="_blank" rel="noopener">hexo-theme-fact</a>.</p><h1 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h1><p>I assume you already have a Hexo blog initialized.</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> &lt;path-to-hexo-folder&gt;/themes</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/artchen/hexo-theme-fact.git fact</span><br></pre></td></tr></table></figure><p>Don’t forget to modify <code>_config.yml</code> under root directory of Hexo blog. Change theme to Fact.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">theme: fact</span><br></pre></td></tr></table></figure><h1 id="Configuration"><a href="#Configuration" class="headerlink" title="Configuration"></a>Configuration</h1><p>Some configuration can be found in <code>_config.yml</code> under the <code>themes/fact</code> directory.</p><h1 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cd</span> &lt;path-to-hexo-folder&gt;/themes/fact</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure><h1 id="Fonts"><a href="#Fonts" class="headerlink" title="Fonts"></a>Fonts</h1><p>I used <a href="https://typekit.com/fonts/futura-pt" target="_blank" rel="noopener">Futura</a> for text, and <a href="https://typekit.com/fonts/inconsolata" target="_blank" rel="noopener">Inconsolata</a> for source code. Both of them are hosted on <a href="https://typekit.com/fonts" target="_blank" rel="noopener">Typekit</a>.</p><p>If you do not use Typekit, here are the necessary steps to switch to other services:</p><ol><li>In <code>layout/_partial/head.ejs</code>, delete the lines that include the typekit library, then include necessary files from your choice of web fonts (eg: <a href="https://www.google.com/fonts" target="_blank" rel="noopener">Google Font</a>).</li><li>In <code>source/css/_sass/style.scss</code>, change the font macros to your choices.</li></ol><h1 id="Screenshot"><a href="#Screenshot" class="headerlink" title="Screenshot"></a>Screenshot</h1><p><img src="https://cdn.artifact.me/images/themes/hexo-theme-fact-screenshot.png" alt="Fact Screenshot"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;strong&gt;Fact&lt;/strong&gt; is a simple but powerful theme for &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;. It comes wit
      
    
    </summary>
    
    
    
      <category term="Theme" scheme="http://artifact.me/tags/theme/"/>
    
      <category term="Hexo" scheme="http://artifact.me/tags/hexo/"/>
    
      <category term="Fact" scheme="http://artifact.me/tags/fact/"/>
    
  </entry>
  
</feed>
